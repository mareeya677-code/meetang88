<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#000000">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Meetang88">
    <title>Meetang88</title>
    <link rel="manifest" href="manifest.json">
    <link rel="icon" href="https://meetang88th.com/static/img/site-logo.webp">
    <link rel="apple-touch-icon" href="https://meetang88th.com/static/img/site-logo.webp">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        html, body {
            width: 100%;
            height: 100%;
            overflow: hidden;
        }
        
        #webapp-frame {
            width: 100%;
            height: 100%;
            border: none;
            display: block;
        }
        
        #loader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }
        
        .logo-container {
            width: 120px;
            height: 120px;
            margin-bottom: 30px;
        }
        
        .logo-container img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }
        
        .spinner {
            border: 4px solid #333;
            border-top: 4px solid #ffd700;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .loading-text {
            color: #ffd700;
            margin-top: 20px;
            font-family: Arial, sans-serif;
            font-size: 16px;
        }
    </style>
</head>
<body>
    <div id="loader">
        <div class="logo-container">
            <img src="https://meetang88th.com/static/img/site-logo.webp" alt="Meetang88" onerror="this.src='site-logo.ico'">
        </div>
        <div class="spinner"></div>
        <div class="loading-text">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î Meetang88...</div>
    </div>

    <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏≠‡∏õ -->
    <div id="install-prompt" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 10000; display: flex; flex-direction: column; justify-content: center; align-items: center; padding: 20px;">
        <div style="background: #1a1a1a; border-radius: 20px; padding: 40px 30px; max-width: 400px; text-align: center; box-shadow: 0 10px 40px rgba(255,215,0,0.3);">
            <img src="https://meetang88th.com/static/img/site-logo.webp" style="width: 100px; height: 100px; margin-bottom: 20px; border-radius: 20px;" onerror="this.src='site-logo.ico'">
            <h2 style="color: #ffd700; margin-bottom: 10px; font-size: 24px;">‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Meetang88</h2>
            <p style="color: #ccc; margin-bottom: 30px; font-size: 16px;">‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÅ‡∏≠‡∏õ‡∏•‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡∏´‡∏•‡∏±‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏á‡πà‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡∏£‡∏ß‡∏î‡πÄ‡∏£‡πá‡∏ß‡∏¢‡∏¥‡πà‡∏á‡∏Ç‡∏∂‡πâ‡∏ô</p>
            <button id="install-button" style="background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%); color: #000; border: none; padding: 16px 40px; font-size: 18px; font-weight: bold; border-radius: 50px; cursor: pointer; width: 100%; margin-bottom: 15px; box-shadow: 0 4px 15px rgba(255,215,0,0.4);">
                üì• ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏•‡∏¢
            </button>
            <button id="cancel-button" style="background: transparent; color: #999; border: 1px solid #444; padding: 12px 30px; font-size: 16px; border-radius: 50px; cursor: pointer; width: 100%;">
                ‡πÑ‡∏ß‡πâ‡∏ó‡∏µ‡∏´‡∏•‡∏±‡∏á
            </button>
        </div>
    </div>
    
    <iframe id="webapp-frame" src="https://meetang88th.com/login"></iframe>

    <script>
        let deferredPrompt;
        const installPrompt = document.getElementById('install-prompt');
        const installButton = document.getElementById('install-button');
        const cancelButton = document.getElementById('cancel-button');
        
        // ‡∏ã‡πà‡∏≠‡∏ô loader ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à
        const iframe = document.getElementById('webapp-frame');
        const loader = document.getElementById('loader');
        
        iframe.addEventListener('load', () => {
            setTimeout(() => {
                loader.style.display = 'none';
            }, 500);
        });

        // ‡∏à‡∏±‡∏ö event beforeinstallprompt (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Android)
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            
            // ‡πÅ‡∏™‡∏î‡∏á‡∏õ‡∏∏‡πà‡∏°‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à
            setTimeout(() => {
                installPrompt.style.display = 'flex';
            }, 1000);
        });

        // ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á
        installButton.addEventListener('click', async () => {
            if (!deferredPrompt) {
                // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ prompt - ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÉ‡∏´‡πâ‡∏ó‡∏≥‡∏î‡πâ‡∏ß‡∏¢‡∏ï‡∏ô‡πÄ‡∏≠‡∏á
                installPrompt.style.display = 'none';
                alert('‡∏Å‡∏î‡πÄ‡∏°‡∏ô‡∏π 3 ‡∏à‡∏∏‡∏î (‚ãÆ) ‡∏°‡∏∏‡∏°‡∏Ç‡∏ß‡∏≤‡∏ö‡∏ô ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å "‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏á‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡∏´‡∏•‡∏±‡∏Å"');
                return;
            }

            installPrompt.style.display = 'none';
            
            try {
                deferredPrompt.prompt();
                
                const { outcome } = await deferredPrompt.userChoice;
                
                if (outcome === 'accepted') {
                    console.log('‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
                } else {
                    // ‡∏ñ‡πâ‡∏≤‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å ‡πÅ‡∏™‡∏î‡∏á‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏≥‡∏î‡πâ‡∏ß‡∏¢‡∏ï‡∏ô‡πÄ‡∏≠‡∏á
                    alert('‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Å‡∏î‡πÄ‡∏°‡∏ô‡∏π 3 ‡∏à‡∏∏‡∏î (‚ãÆ) ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å "‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏á‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡∏´‡∏•‡∏±‡∏Å"');
                }
                
                deferredPrompt = null;
            } catch (err) {
                console.error('‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß:', err);
                alert('‡∏Å‡∏î‡πÄ‡∏°‡∏ô‡∏π 3 ‡∏à‡∏∏‡∏î (‚ãÆ) ‡∏°‡∏∏‡∏°‡∏Ç‡∏ß‡∏≤‡∏ö‡∏ô ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å "‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏á‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡∏´‡∏•‡∏±‡∏Å"');
            }
        });

        // ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
        cancelButton.addEventListener('click', () => {
            installPrompt.style.display = 'none';
        });

        // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏•‡πâ‡∏ß‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏±‡∏á
        if (window.matchMedia('(display-mode: standalone)').matches || window.navigator.standalone === true) {
            installPrompt.style.display = 'none';
        }

        // ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö iOS ‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏£‡∏ì‡∏µ‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö beforeinstallprompt
        const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;
        
        // ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô iOS ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏°‡∏µ deferredPrompt ‡∏´‡∏•‡∏±‡∏á 2 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ ‡πÅ‡∏™‡∏î‡∏á popup ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥
        setTimeout(() => {
            if (!deferredPrompt || isIOS) {
                if (isIOS && !window.navigator.standalone) {
                    installPrompt.style.display = 'flex';
                    document.getElementById('install-button').textContent = 'üì± ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡∏ö‡∏ô iPhone';
                } else if (!deferredPrompt) {
                    // Android ‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà‡∏°‡∏µ beforeinstallprompt
                    installPrompt.style.display = 'flex';
                    document.getElementById('install-button').textContent = 'üì• ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á';
                }
            }
        }, 2000);

        // ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
        window.addEventListener('appinstalled', () => {
            installPrompt.style.display = 'none';
            console.log('PWA ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢');
        });

        // ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô Service Worker
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('sw.js')
                    .then(registration => {
                        console.log('Service Worker registered:', registration.scope);
                    })
                    .catch(error => {
                        console.log('Service Worker registration failed:', error);
                    });
            });
        }

        // ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô zoom
        document.addEventListener('gesturestart', function(e) {
            e.preventDefault();
        });

        document.addEventListener('touchmove', function(e) {
            if (e.scale !== 1) {
                e.preventDefault();
            }
        }, { passive: false });
    </script>
</body>
</html>